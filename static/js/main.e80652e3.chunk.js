(this.webpackJsonpcorona=this.webpackJsonpcorona||[]).push([[0],{168:function(e,t,a){e.exports=a(281)},174:function(e,t,a){},281:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(150),s=a.n(r),c=a(151),o=a(106),u=a.n(o),l=a(152),d=a(50),f=a(163),m=a(165),h=(a(174),a(291)),p=a(295),y=a(292),g=a(300),k=a(296),b=a(298),v=a(293),E=function e(t,a){var n=this;Object(d.a)(this,e),this.getUninfected=function(){return n.population-n.totalInfected},this.getPeopleIncubating=function(){var e=n.sim.state.incubationDays;return n.infectedByDay.slice(0,e).reduce((function(e,t){return e+t}),0)},this.getPeopleInfectious=function(){var e=n.sim.state.incubationDays,t=n.sim.state.incubationDays+n.sim.state.infectiveDays;return n.infectedByDay.slice(e,t).reduce((function(e,t){return e+t}),0)},this.startDay=function(e){n.day=e,n.infectedByDay.unshift(0),n.newInfections=0},this.processInteractions=function(e){var t=e.interactionRate*n.interactionRate*n.sim.getMitigationMult(),a=n.getUninfected()/n.population,i=e.getPeopleInfectious()*t*a*n.spreadMult;n.newInfections+=i},this.endDay=function(){n.infectedByDay[0]=n.newInfections,n.totalInfected+=n.newInfections};var i=t.bucketsData.reduce((function(e,t){return e+t.relativeSize}),0),r=a.relativeSize/i,s=t.state.population*r,c=t.state.initialInfected*r;this.sim=t,this.population=s,this.interactionRate=a.spreadMultiple,this.totalInfected=c,this.infectedByDay=[c],this.totalDeaths=0,this.newInfections=0,this.newDeaths=0,this.spreadMult=this.sim.R0Adj*r/this.sim.state.infectiveDays},I=function e(t){var a=this;Object(d.a)(this,e),this.calculateR0Adj=function(e){var t=[],n=[];e.forEach((function(a){e.forEach((function(e){t.push(a.spreadMultiple*e.spreadMultiple),n.push(a.spreadMultiple*a.relativeSize*e.relativeSize)}))}));var i=function(e,t){var a=e.map((function(e,a){var n=t[a];return[e*n,n]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]);return a[0]/a[1]}(t,n);return a.state.initialR0/i},this.getResults=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||a.state.useAnimate){var t=a.dailyData.effectiveR0.findIndex((function(e){return e>1})),n=a.dailyData.effectiveR0.findIndex((function(e,n){return e<1&&n>t&&!a.inLockdown(n+1)})),i=n>2?(a.dailyData.infected[n-1]+a.dailyData.infected[n-2])/2:0,r=Array(a.dailyData.effectiveR0.length).fill(i),s=a.getChartBuckets(),c=a.getChartBucketsCategories();return{bucketsUsed:a.state.useBuckets,infectious:a.dailyData.infectious,infected:a.dailyData.infected,deaths:a.dailyData.deaths,effectiveR0:a.dailyData.effectiveR0,buckets:s,bucketCategories:c,herdImmunity:r}}},this.processDay=function(e){return a.day=e,a.buckets.map((function(t){return t.startDay(e)})),a.startOfDayInfectious=a.getInfectious(),a.buckets.forEach((function(e){a.buckets.forEach((function(t){t.processInteractions(e)}))})),a.buckets.map((function(e){return e.endDay()})),a.dailyData.infectious.push(a.getInfectiousPercent()),a.dailyData.infected.push(a.getInfectedPercent()),a.dailyData.deaths.push(a.getDeathsPercent()),a.dailyData.effectiveR0.push(a.getEffectiveR0()),a.getResults()},this.finishRun=function(){return a.buckets.forEach((function(e){console.log("--------- bucket ---------"),console.log("Interaction Rate: ".concat(e.interactionRate)),console.log("Infected: ".concat(e.totalInfected/e.population))})),a.getResults(!0)},this.getInfectious=function(){return a.buckets.map((function(e){return e.getPeopleInfectious()})).reduce((function(e,t){return e+t}))},this.getInfected=function(){return a.buckets.map((function(e){return e.totalInfected})).reduce((function(e,t){return e+t}))},this.getDeaths=function(){return a.buckets.map((function(e){return e.totalDeaths})).reduce((function(e,t){return e+t}))},this.getNewInfections=function(){return a.buckets.map((function(e){return e.newInfections})).reduce((function(e,t){return e+t}))},this.getNewDeaths=function(){return a.buckets.map((function(e){return e.newDeaths})).reduce((function(e,t){return e+t}))},this.getInfectiousPercent=function(){return a.getInfectious()/a.state.population},this.getInfectedPercent=function(){return a.getInfected()/a.state.population},this.getDeathsPercent=function(){return a.getDeaths()/a.state.population},this.getEffectiveR0=function(){return a.getNewInfections()/a.startOfDayInfectious*a.state.infectiveDays||0},this.getChartBuckets=function(){return a.buckets.map((function(e,t){return{x:t+1,y:e.totalInfected/e.population}}))},this.getChartBucketsCategories=function(){var e=[];return a.buckets.forEach((function(t){var n=a.getLabel("".concat(t.interactionRate,"x"),e);e.push(n)})),e},this.getLabel=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=0===n?e:"".concat(e,".").concat(n);return t.includes(i)?a.getLabel(e,t,n+1):i},this.inLockdown=function(e){if(a.state.lockdownEffectiveness>0){var t=a.state.lockdownStart+a.state.lockdownDays;return e>=a.state.lockdownStart&&e<t}},this.getMitigationMult=function(){return a.inLockdown(a.day)?1-a.state.lockdownEffectiveness:1},this.state=t,this.day=0,this.bucketsData=t.useBuckets?t.buckets:t.naiveModelBuckets,this.R0Adj=this.calculateR0Adj(this.bucketsData),this.buckets=this.bucketsData.map((function(e){return new E(a,e)})),this.dailyData={infectious:[],infected:[],deaths:[],effectiveR0:[]}},D=(a(113),a(153)),S=a(55),w=a(107),C=a(164),R=a(44),B=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){n.runSimulation()},n.runSimulation=Object(l.a)(u.a.mark((function e(){var t,a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("runSimulation"),!n.state.useBuckets){e.next=5;break}return t=n.bucketTextInput.current.value.trim().split("\n").map((function(e){return JSON.parse(e)})),e.next=5,n.setState({buckets:t});case 5:if(n.setState({results:n.emptyResults,usedBuckets:n.state.useBuckets}),n.day=0,n.sim=new I(n.state),clearInterval(n.timer),n.state.useAnimate)n.timer=setInterval((function(){n.animateDay()}),100);else{for(a=1;a<=n.state.days;a++)n.sim.processDay(a);i=n.sim.finishRun(),n.setState({results:i})}case 10:case"end":return e.stop()}}),e)}))),n.animateDay=function(){if(n.day++,n.day<n.state.days){var e=n.sim.processDay(n.day);n.setState({results:e})}else clearInterval(n.timer),n.sim.finishRun()},n.changeInput=function(e,t){n.setState(Object(c.a)({},e,t))},n.render=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{backgroundColor:"#371A32",padding:20,paddingTop:30,paddingBottom:30,fontSize:15,color:"white"}},i.a.createElement("h2",{style:{fontWeight:"bold",color:"white"}},"Coronavirus Super Spreader Model"),i.a.createElement("span",null,"Created by ",i.a.createElement("a",{style:{color:"#F2C7EB"},href:"https://twitter.com/jspaulding"},"Jesse Spaulding"),". Source code available on ",i.a.createElement("a",{style:{color:"#F2C7EB"},href:"https://github.com/jspauld/coronavirus-super-spreader-model"},"GitHub"))),n.renderDescription(),i.a.createElement(D.a,{fluid:!0},i.a.createElement(w.a,{className:"h-100"},n.renderLeftCol(),n.renderRightCol())))},n.renderDescription=function(){return i.a.createElement("div",{style:{backgroundColor:"#F2C7EB",padding:20,fontSize:15,borderRadius:0}},i.a.createElement("p",{style:{maxWidth:1e3}},i.a.createElement("b",null,"About this model:")," This model helps visualize how heterogeneity in the population affects the level at which we can expect to achieve herd immunity. I created this because some epidemiologists have been ",i.a.createElement("a",{href:"https://www.nytimes.com/2020/05/01/opinion/sunday/coronavirus-herd-immunity.html"},"making arguments against herd immunity")," using naive models that fail to account for heterogeneity entirely."),i.a.createElement("p",{style:{maxWidth:1e3}},i.a.createElement("b",null,"Why heterogenity matters:")," Not everyone is alike in their likelihood of catching and spreading the virus. Someone who lives in a dense urban area and goes to crowded bars every night is ",i.a.createElement("i",null,"MUCH"),' more likely to contract and spread the virus than a person who sits at home playing video games all day. "Super spreaders" catch the virus first, and as they become immune the R0 is lowered among the remaining population.'),i.a.createElement("p",{style:{maxWidth:1e3}},i.a.createElement("b",null,"Disclaimer:")," I'm not an epidemiologist. There may be errors in my code. The source code is available on ",i.a.createElement("a",{href:"https://github.com/jspauld/coronavirus-super-spreader-model"},"GitHub"),"."))},n.renderLeftCol=function(){var e=n.state.buckets.reduce((function(e,t){return"".concat(e).concat(JSON.stringify(t),"\n")}),"");return i.a.createElement(S.a,{sm:5,style:{backgroundColor:"#F1EBF0",paddingTop:30,paddingBottom:30}},i.a.createElement("h4",{style:{marginBottom:20}},"Choose model"),i.a.createElement(R.a.Check,{id:"useBucketsYes",name:"useBuckets",type:"radio",label:"Heterogeneous (accounts for super spreaders)",onChange:function(e){return n.changeInput(e.target.name,!0)},defaultChecked:n.state.useBuckets}),i.a.createElement(R.a.Check,{id:"useBucketsNo",name:"useBuckets",type:"radio",label:"Naive",onChange:function(e){return n.changeInput(e.target.name,!1)},defaultChecked:!n.state.useBuckets}),n.state.useBuckets&&i.a.createElement(i.a.Fragment,null,i.a.createElement("h4",{style:{marginTop:20}},"Population buckets"),i.a.createElement("div",{style:{fontSize:14,marginTop:10,marginBottom:5}},"Each line below represents a population bucket, each with a 'spreadMultiple' that defines how likely those people are to catch & spread the virus. Add, remove, or edit buckets to see the effect."),i.a.createElement(R.a.Control,{ref:n.bucketTextInput,as:"textarea",defaultValue:e,style:{height:200,fontSize:14}})),i.a.createElement(R.a.Check,{id:"useAnimate",name:"useAnimate",type:"checkbox",label:"Animate charts",style:{marginTop:30},onChange:function(e){return n.changeInput(e.target.name,e.target.checked)},defaultChecked:n.state.useAnimate}),n.renderSimulateButton(),i.a.createElement("h4",{style:{marginTop:30}},"Parameters"),n.inputs.map((function(e){return n.renderInput(e)})),n.renderSimulateButton())},n.renderSimulateButton=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(C.a,{variant:"primary",className:"btn-lg",onClick:n.runSimulation,style:{marginTop:20}},"Run Simulation"))},n.renderInput=function(e){return i.a.createElement(R.a.Group,{key:e[1],as:w.a,className:"inputContainer"},i.a.createElement(R.a.Label,{column:!0,sm:"6",style:{fontSize:14}},e[0]),i.a.createElement(S.a,{sm:"6"},i.a.createElement(R.a.Control,{type:"text",id:e[1],defaultValue:e[2],onChange:function(e){return n.changeInput(e.target.id,Number(e.target.value))}})))},n.renderRightCol=function(){return i.a.createElement(S.a,{sm:7,style:{paddingTop:30}},i.a.createElement("div",null,i.a.createElement("h4",null,"Population infected over time"),n.renderInfectedChart(),n.state.usedBuckets&&i.a.createElement(i.a.Fragment,null,i.a.createElement("h4",null,"Population infected by bucket"),i.a.createElement("p",null,"The population is divided into buckets according to likelihood of catching and spreading the virus."),n.renderBucketsChart()),i.a.createElement("h4",null,"R0 over time"),n.renderR0Chart()))},n.renderInfectedChart=function(){return i.a.createElement(h.a,{theme:p.a.material,domain:{x:[0,n.state.days],y:[0,1]},style:{labels:{fontSize:8}},height:270},i.a.createElement(y.a,{x:10,y:10,centerTitle:!0,orientation:"horizontal",gutter:20,style:{title:{fontSize:14},labels:{fontSize:10}},data:[{name:"Infectious",symbol:{fill:"orange"}},{name:"Infected Population",symbol:{fill:"purple"}},{name:"Herd Immunity",symbol:{fill:"pink"}}]}),i.a.createElement(g.a,null),i.a.createElement(g.a,{dependentAxis:!0,tickFormat:function(e){return"".concat(100*e,"%")}}),i.a.createElement(k.a,{data:n.state.results.infectious,style:{data:{fill:"orange",opacity:1}}}),i.a.createElement(b.a,{data:n.state.results.infected,style:{data:{stroke:"purple",opacity:1}}}),i.a.createElement(b.a,{data:n.state.results.herdImmunity,style:{data:{stroke:"pink",strokeWidth:2,opacity:1}}}))},n.renderBucketsChart=function(){return i.a.createElement(h.a,{theme:p.a.material,domain:{y:[0,1]},domainPadding:20,height:220},i.a.createElement(g.a,null),i.a.createElement(g.a,{dependentAxis:!0,tickFormat:function(e){return"".concat(100*e,"%")}}),i.a.createElement(v.a,{data:n.state.results.buckets,categories:{x:n.state.results.bucketCategories},style:{data:{fill:"purple"}}}))},n.renderR0Chart=function(){return i.a.createElement(h.a,{theme:p.a.material,domain:{x:[0,n.state.days],y:[0,4]},height:220},i.a.createElement(y.a,{x:10,y:10,centerTitle:!0,orientation:"horizontal",gutter:20,style:{title:{fontSize:14},labels:{fontSize:10}},data:[{name:"R0 Over Time",symbol:{fill:"purple"}}]}),i.a.createElement(g.a,null),i.a.createElement(g.a,{dependentAxis:!0}),i.a.createElement(b.a,{data:n.state.results.effectiveR0,style:{data:{stroke:"purple",opacity:1}}}))},n.emptyResults={buckets:[],bucketCategories:[],infectious:[],infected:[],deaths:[],effectiveR0:[],herdImmunity:[]},n.state={useBuckets:!0,usedBuckets:!0,useAnimate:!0,naiveModelBuckets:[{relativeSize:1,spreadMultiple:1}],buckets:[{relativeSize:1,spreadMultiple:20},{relativeSize:5,spreadMultiple:5},{relativeSize:20,spreadMultiple:2},{relativeSize:48,spreadMultiple:1},{relativeSize:20,spreadMultiple:.5},{relativeSize:5,spreadMultiple:.25},{relativeSize:1,spreadMultiple:.1}],results:n.emptyResults},n.day=0,n.sim=null,n.inputs=[["Population","population",1e6],["Initial infected","initialInfected",1e3],["Initial R0","initialR0",2.5],["Days before infectious","incubationDays",3],["Days Infectious","infectiveDays",7],["Days in chart","days",150],["Mitigation start day","lockdownStart",60],["Mitigation days","lockdownDays",14],["Mitigation effectiveness","lockdownEffectiveness",0]],n.inputs.forEach((function(e){n.state[e[1]]=e[2]})),n.bucketTextInput=i.a.createRef(),n}return a}(i.a.Component);s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(B,null)),document.getElementById("root"))}},[[168,1,2]]]);
//# sourceMappingURL=main.e80652e3.chunk.js.map